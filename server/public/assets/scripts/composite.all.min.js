/*! comicompanion_app 2016-05-13 */
var app=angular.module("comicApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/shopping",{templateUrl:"views/partials/shopping.html",controller:"ShoppingController",controllerAs:"shopping"}).when("/reading",{templateUrl:"views/partials/reading.html",controller:"ReadingController",controllerAs:"reading"}).when("/history",{templateUrl:"views/partials/history.html",controller:"HistoryController",controllerAs:"history"}),b.html5Mode(!0)}]),app.filter("unique",function(){return function(a,b){var c=[],d=[];return angular.forEach(a,function(a){var e=a[b];-1===d.indexOf(e)&&(d.push(e),c.push(a))}),c}}),app.factory("ComicService",function(){var a={},b=[],c="",d=[],e=[],f=[];return{comicEntry:a,comicEntries:b,userName:c,checkedItems:d,readItems:e,selectionOptions:f}}),app.controller("HistoryController",["$http","ComicService",function(a,b){var c=this;c.comicEntry=b.comicEntry,c.comicEntries=b.comicEntries,c.readItems=b.readItems,c.getAll=function(){a.get("/history/rated").then(function(a){console.log("getting all read comics"),console.log(a.data),c.readItems=a.data})},c.deleteLog=function(b){a["delete"]("/history/delete/"+b._id).then(function(a){console.log("comic deleted (I think)"),a.sendStatus(200)}),c.getAll()},c.editLog=function(){c.showDeleteButtons=!0},c.doneEditingLog=function(){c.showDeleteButtons=!1},c.getAll()}]),app.controller("ReadingController",["$http","ComicService",function(a,b){var c=this;c.comicEntry=b.comicEntry,c.comicEntries=b.comicEntries,c.readItems=b.readItems,c.getAll=function(){a.get("/reading/purchased").then(function(a){console.log(a.data),c.comicEntries=a.data})},c.doneReading=function(b){console.log("clicked doneReading()"),a.put("/reading/changeToRead",b).then(function(a){console.log(a),c.readItems.push(a.data),c.getAll()}),console.log("readItems list:",c.readItems)},c.getAll()}]),app.controller("ShoppingController",["$http","ComicService",function(a,b){var c=this;c.comicEntry=b.comicEntry,c.comicEntries=b.comicEntries,c.selectionOptions=b.selectionOptions,c.checkedItems=b.checkedItems,c.getAll=function(){a.get("/shopping/unpurchased").then(function(a){c.comicEntries=a.data}),a.get("/shopping/all").then(function(a){c.selectionOptions=a.data})},c.makeEntry=function(){a.post("/shopping/submitComic",c.comicEntry).then(function(a){c.comicEntry.purchased===!1,c.comicEntry.alreadyRead===!1,c.comicEntry={},c.showEntryBox=!1,c.getAll()})},c.purchaseValue=function(){console.log("clicked"),console.log(c.getAllChecked()),a.put("/shopping/markComicsPurchased",c.checkedItems).then(function(a){console.log(a),c.getAll()})},c.getAllChecked=function(){for(var a=0;a<c.comicEntries.length;a++)c.comicEntries[a].purchased&&c.checkedItems.push(c.comicEntries[a]);return c.checkedItems},c.getAll()}]);